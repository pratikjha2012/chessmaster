<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ChessMaster Home</title>
<style>
body {
  margin:0; font-family:'Arial', sans-serif; overflow-x:hidden; 
  background:linear-gradient(135deg,#1a1a2e,#0f0f1f); color:#fff; 
  position:relative; min-height:100vh;
}

/* Floating background pieces */
.chess-bg{
  position:absolute; top:0; left:0; width:100%; height:100%; 
  pointer-events:none; overflow:hidden; z-index:0;
}
.chess-piece{
  position:absolute; font-size:24px; opacity:0.08;
  animation:movePiece linear infinite;
}
@keyframes movePiece{
  0%{transform:translateY(-50px);}
  100%{transform:translateY(110vh);}
}

/* Navbar */
nav{
  width:100%; display:flex; justify-content:space-between; align-items:center;
  padding:15px 30px; background:rgba(0,0,0,0.5); backdrop-filter:blur(6px);
  position:fixed; top:0; left:0; z-index:1000;
}
nav .logo{ font-size:1.5em; font-weight:bold; color:#ff9800;}
nav .menu{display:flex; gap:20px; align-items:center;}
nav .menu a{color:#fff; text-decoration:none; font-weight:500; transition:0.3s;}
nav .menu a:hover{color:#ff5722;}
nav .profile{display:flex; align-items:center; gap:10px; cursor:pointer; position:relative;}
nav .profile img{width:35px;height:35px;border-radius:50%;border:2px solid #ff9800;}

/* Auth buttons */
.auth-buttons{display:flex;gap:10px;align-items:center;}
.btn-login,.btn-register{padding:8px 16px;border-radius:6px;border:none;cursor:pointer;font-weight:500;transition:0.3s;}
.btn-login{background:#4caf50;color:#fff;}
.btn-login:hover{background:#45a049;}
.btn-register{background:#2196f3;color:#fff;}
.btn-register:hover{background:#1976d2;}
.auth-buttons.hidden{display:none;}

/* Hero section */
.hero{
  margin-top:80px; text-align:center; padding:60px 20px; position:relative; z-index:1;
}
.hero h1{font-size:3em; margin-bottom:15px; text-shadow:2px 2px 8px #000;}
.hero p{font-size:1.2em; margin-bottom:30px; color:#ccc; max-width:700px; margin-left:auto; margin-right:auto;}
.btn-play{
  padding:15px 30px; font-size:1.1em; border-radius:10px; background:#ff5722; border:none; color:#fff; cursor:pointer;
  transition:0.3s;
}
.btn-play:hover{background:#e64a19;}

/* Puzzle section */
.puzzle-section{
  display:flex; justify-content:center; flex-wrap:wrap; gap:20px; margin:40px 20px; z-index:1; position:relative;
}
.puzzle-card{
  background:rgba(255,255,255,0.05); padding:20px; border-radius:10px; width:220px; text-align:center;
  backdrop-filter:blur(6px); cursor:pointer; transition:0.3s;
}
.puzzle-card:hover{background:rgba(255,255,255,0.15);}
.puzzle-card h3{margin-bottom:10px;}
.puzzle-card p{font-size:0.9em; color:#ccc;}

/* Settings popup */
#settingsPopup{
  position:fixed; inset:0; background:rgba(0,0,0,0.85); display:flex; align-items:center; justify-content:center;
  z-index:9999; opacity:0; pointer-events:none; transition:0.3s;
}
#settingsPopup.active{opacity:1; pointer-events:auto;}
.popup-box{
  background:#22223b; padding:20px; border-radius:12px; width:360px; text-align:center; box-shadow:0 10px 30px rgba(0,0,0,0.5); transform: scale(0.8); transition:0.3s;
}
#settingsPopup.active .popup-box{transform: scale(1);}
.popup-box h2{margin-bottom:15px;color:#ff9800;}
.popup-box select,.popup-box input[type=checkbox]{margin:10px 0;padding:6px;border-radius:6px;border:none;width:80%;}
.popup-box .actions{margin-top:15px; display:flex; justify-content:center; gap:12px;}
</style>
</head>
<body>

<!-- Floating background -->
<div class="chess-bg" id="bgContainer"></div>

<!-- Navbar -->
<nav>
  <div class="logo">ChessMaster</div>
  <div class="menu">
    <a href="game.html">Play</a>
    <a href="bot2.html">Play Bot</a>
    <a href="puzzle.html">Puzzle</a>
    <a href="#">Leaderboard</a>
    <a href="#" onclick="openSettings();return false;">Settings</a>
  </div>
  <div class="profile" onclick="openProfile()">
    <img src="avatar.png" alt="Profile">
    <span id="profileName">Player1</span>
  </div>
  <div class="auth-buttons" id="authButtons">
    <button class="btn-login" onclick="openLogin()">Login</button>
    <button class="btn-register" onclick="openRegister()">Register</button>
  </div>
</nav>

<!-- Hero section -->
<div class="hero">
  <h1>Welcome to ChessMaster!</h1>
  <p>Challenge the bot, solve puzzles, improve your chess skills, and enjoy a modern chess experience.</p>
  <button class="btn-play" onclick="location.href='game.html'">Play Now</button>
</div>

<!-- Puzzle section -->
<div class="puzzle-section">
  <div class="puzzle-card" onclick="location.href='puzzle.html'">
    <h3>Daily Puzzle</h3>
    <p>Solve today's puzzle and test your tactics!</p>
  </div>
  <div class="puzzle-card" onclick="location.href='puzzle.html'">
    <h3>Random Puzzle</h3>
    <p>Try a random puzzle for fun and challenge.</p>
  </div>
</div>

<!-- Settings popup -->
<div id="settingsPopup">
  <div class="popup-box">
    <h2>Settings</h2>
    <label>Theme:</label>
    <select id="themeSelect">
      <option value="dark">Dark</option>
      <option value="light">Light</option>
      <option value="classic">Classic</option>
    </select>
    <label><input type="checkbox" id="showHints" checked> Show Hints</label>
    <label>Difficulty:</label>
    <select id="difficultySelect">
      <option value="easy">Easy</option>
      <option value="medium">Medium</option>
      <option value="hard">Hard</option>
    </select>
    <div class="actions">
      <button onclick="applySettings()">Apply</button>
      <button onclick="closeSettings()">Close</button>
    </div>
  </div>
</div>

<!-- Profile popup -->
<div id="profilePopup" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;z-index:999;">
  <div style="background:#fff;padding:20px;border-radius:10px;width:300px;text-align:center;">
    <h2>Edit Profile</h2>
    <input type="text" id="usernameInput" placeholder="Username" style="width:80%;padding:5px;margin:10px 0;">
    <input type="text" id="avatarInput" placeholder="Avatar URL" style="width:80%;padding:5px;margin:10px 0;">
    <div style="margin-top:15px;">
      <button onclick="saveProfile()">Save</button>
      <button onclick="closeProfile()">Close</button>
      <button onclick="logout()" style="background:#f44336;color:#fff;padding:5px 10px;border:none;border-radius:4px;cursor:pointer;margin-top:10px;">Logout</button>
    </div>
  </div>
</div>

<!-- Login popup -->
<div id="loginPopup" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;z-index:999;">
  <div style="background:#22223b;padding:20px;border-radius:12px;width:360px;text-align:center;box-shadow:0 10px 30px rgba(0,0,0,0.5);">
    <h2 style="color:#ff9800;margin-bottom:15px;">Login</h2>
    <input type="text" id="loginUsername" placeholder="Username" style="width:80%;padding:10px;margin:10px 0;border-radius:6px;border:none;background:#334155;color:#fff;">
    <input type="password" id="loginPassword" placeholder="Password" style="width:80%;padding:10px;margin:10px 0;border-radius:6px;border:none;background:#334155;color:#fff;">
    <div style="margin-top:15px;">
      <button onclick="login()" style="background:#4caf50;color:#fff;padding:10px 20px;border:none;border-radius:6px;cursor:pointer;margin:0 5px;">Login</button>
      <button onclick="closeLogin()" style="background:#666;color:#fff;padding:10px 20px;border:none;border-radius:6px;cursor:pointer;margin:0 5px;">Close</button>
    </div>
  </div>
</div>

<!-- Register popup -->
<div id="registerPopup" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;z-index:999;">
  <div style="background:#22223b;padding:20px;border-radius:12px;width:360px;text-align:center;box-shadow:0 10px 30px rgba(0,0,0,0.5);">
    <h2 style="color:#ff9800;margin-bottom:15px;">Register</h2>
    <input type="text" id="registerUsername" placeholder="Username" style="width:80%;padding:10px;margin:10px 0;border-radius:6px;border:none;background:#334155;color:#fff;">
    <input type="password" id="registerPassword" placeholder="Password" style="width:80%;padding:10px;margin:10px 0;border-radius:6px;border:none;background:#334155;color:#fff;">
    <input type="password" id="confirmPassword" placeholder="Confirm Password" style="width:80%;padding:10px;margin:10px 0;border-radius:6px;border:none;background:#334155;color:#fff;">
    <div style="margin-top:15px;">
      <button onclick="register()" style="background:#2196f3;color:#fff;padding:10px 20px;border:none;border-radius:6px;cursor:pointer;margin:0 5px;">Register</button>
      <button onclick="closeRegister()" style="width:80%;padding:10px;margin:10px 0;border-radius:6px;border:none;background:#334155;color:#fff;">Close</button>
    </div>
  </div>
</div>

<script>
// Floating pieces
const bgContainer=document.getElementById('bgContainer');
const pieces=['♔','♕','♖','♗','♘','♙','♚','♛','♜','♝','♞','♟'];
for(let i=0;i<40;i++){
  const p=document.createElement('div');
  p.className='chess-piece';
  p.textContent=pieces[Math.floor(Math.random()*pieces.length)];
  p.style.left=Math.random()*100+'vw';
  p.style.fontSize=(20+Math.random()*30)+'px';
  p.style.animationDuration=(10+Math.random()*15)+'s';
  bgContainer.appendChild(p);
}

// Settings
const settingsPopup=document.getElementById('settingsPopup');
function openSettings(){settingsPopup.classList.add('active');}
function closeSettings(){settingsPopup.classList.remove('active');}
function applySettings(){
  const theme=document.getElementById('themeSelect').value;
  if(theme==='dark') document.body.style.background='linear-gradient(135deg,#1a1a2e,#0f0f1f)';
  else if(theme==='light') document.body.style.background='#f4f4f4', document.body.style.color='#000';
  else if(theme==='classic') document.body.style.background='linear-gradient(#f0d9b5,#b58863)', document.body.style.color='#000';
  closeSettings();
}

// Profile
const profilePopup=document.getElementById('profilePopup');
function openProfile(){profilePopup.style.display='flex';}
function closeProfile(){profilePopup.style.display='none';}
function saveProfile(){
  const username=document.getElementById('usernameInput').value;
  const avatar=document.getElementById('avatarInput').value;
  if(username) document.getElementById('profileName').textContent=username;
  if(avatar) document.querySelector('.profile img').src=avatar;
  closeProfile();
}

// Authentication functions
function openLogin(){
  document.getElementById('loginPopup').style.display='flex';
}
function closeLogin(){
  document.getElementById('loginPopup').style.display='none';
}
function openRegister(){
  document.getElementById('registerPopup').style.display='flex';
}
function closeRegister(){
  document.getElementById('registerPopup').style.display='none';
}

async function login(){
  const username=document.getElementById('loginUsername').value;
  const password=document.getElementById('loginPassword').value;
  
  if(!username || !password){
    alert('Please enter both username and password');
    return;
  }
  
  try{
    const response=await fetch('/api/login',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({username,password})
    });
    
    const data=await response.json();
    if(data.success){
      localStorage.setItem('token',data.token);
      localStorage.setItem('username',username);
      document.getElementById('profileName').textContent=username;
      document.getElementById('authButtons').classList.add('hidden');
      document.querySelector('.profile').style.display='flex';
      closeLogin();
      alert('Login successful!');
    }else{
      alert(data.message || 'Login failed');
    }
  }catch(error){
    alert('Login failed. Please try again.');
  }
}

async function register(){
  const username=document.getElementById('registerUsername').value;
  const password=document.getElementById('registerPassword').value;
  const confirmPass=document.getElementById('confirmPassword').value;
  
  if(!username || !password || !confirmPass){
    alert('Please fill all fields');
    return;
  }
  
  if(password !== confirmPass){
    alert('Passwords do not match');
    return;
  }
  
  try{
    const response=await fetch('/api/register',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({username,password})
    });
    
    const data=await response.json();
    if(data.success){
      alert('Registration successful! Please login.');
      closeRegister();
      openLogin();
    }else{
      alert(data.message || 'Registration failed');
    }
  }catch(error){
    alert('Registration failed. Please try again.');
  }
}

// Check authentication status on page load
function checkAuth(){
  const token=localStorage.getItem('token');
  const username=localStorage.getItem('username');
  
  if(token && username){
    document.getElementById('profileName').textContent=username;
    document.getElementById('authButtons').classList.add('hidden');
    document.querySelector('.profile').style.display='flex';
  }else{
    document.querySelector('.profile').style.display='none';
    document.getElementById('authButtons').classList.remove('hidden');
  }
}

// Logout function
function logout(){
  localStorage.removeItem('token');
  localStorage.removeItem('username');
  checkAuth();
}

// Check authentication on page load
checkAuth();
</script>
</body>
</html>
